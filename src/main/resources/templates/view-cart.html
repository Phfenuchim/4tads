<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Carrinho</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" th:href="@{/css/admin/view-cart.css}">
</head>
<body class="d-flex flex-column min-vh-100">

<th:block th:replace="~{fragments/header :: header}"></th:block>

<main class="container my-5 flex-grow-1">
  <div class="row">
    <!-- Lista de Itens -->
    <div class="col-lg-8">
      <h3 class="fw-bold mb-4">Shopping Cart <span th:text="'(' + ${cart.size()} + ' items)'"></span></h3>

      <div th:if="${cart.isEmpty()}" class="alert alert-info">
        Seu carrinho está vazio.
      </div>

      <div th:each="item : ${cart}" class="cart-item d-flex align-items-center justify-content-between">
        <div class="d-flex align-items-center gap-3">
          <img th:src="@{'/images/produtos/' + ${item.imageUrl}}" class="cart-product-img">
          <div>
            <h6 class="mb-1" th:text="${item.productName}">Produto</h6>
            <small>R$ <span th:text="${item.price}">0.00</span></small>
          </div>
        </div>

        <!-- Controle de Quantidade -->
        <div class="d-flex align-items-center gap-2">
          <!-- Decrease -->
          <form th:action="@{/cart/decrease}" method="post">
            <input type="hidden" name="productId" th:value="${item.productId}">
            <button type="submit" class="btn btn-outline-secondary btn-sm px-2">−</button>
          </form>

          <span th:text="${item.quantity}"></span>

          <!-- Increase -->
          <form th:action="@{/cart/increase}" method="post">
            <input type="hidden" name="productId" th:value="${item.productId}">
            <button type="submit" class="btn btn-outline-secondary btn-sm px-2">+</button>
          </form>
        </div>

        <!-- Subtotal -->
        <div>
          <strong>R$ <span th:text="${item.price * item.quantity}">0.00</span></strong>
        </div>

        <!-- Remover -->
        <form th:action="@{/cart/remove}" method="post">
          <input type="hidden" name="productId" th:value="${item.productId}">
          <button type="submit" class="btn btn-link text-danger">✕</button>
        </form>
      </div>

      <div class="mt-4">
        <a href="/products" class="text-decoration-none">&larr; Continuar Comprando</a>
      </div>
    </div>

    <!-- Resumo -->
    <div class="col-lg-4 mt-5 mt-lg-0">
      <div class="cart-summary">
        <h5 class="fw-bold mb-3">Resumo</h5>

        <div class="d-flex justify-content-between mb-2">
          <span>Itens</span>
          <span>R$ <span th:text="${total}">0.00</span></span>
        </div>

        <div class="mb-3">
          <label for="shipping" class="form-label">Frete</label>
          <select id="shipping" class="form-select">
            <option>Entrega Padrão - R$ 10.00</option>
            <option>Expressa - R$ 25.00</option>
          </select>
        </div>

        <div class="mb-3">
          <label for="code" class="form-label">Cupom</label>
          <div class="input-group">
            <input type="text" id="code" class="form-control" placeholder="Digite seu código">
            <button class="btn btn-outline-secondary" type="button">Aplicar</button>
          </div>
        </div>

        <hr>

        <div class="d-flex justify-content-between fw-bold mb-3">
          <span>Total</span>
          <span>R$ <span th:text="${total}">0.00</span></span>
        </div>

        <a href="/checkout" class="btn btn-dark w-100">Finalizar Compra</a>
      </div>
    </div>
  </div>
</main>

<th:block th:replace="~{fragments/footer :: footer}"></th:block>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
